<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Ultimate Deconvolution • udr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Ultimate Deconvolution">
<meta property="og:description" content="udr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">udr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-147</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stephenslab/udr" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to Ultimate Deconvolution</h1>
                        <h4 data-toc-skip class="author">Peter
Carbonetto</h4>
            
            <h4 data-toc-skip class="date">2023-04-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stephenslab/udr/blob/HEAD/vignettes/udr_intro.Rmd" class="external-link"><code>vignettes/udr_intro.Rmd</code></a></small>
      <div class="hidden name"><code>udr_intro.Rmd</code></div>

    </div>

    
    
<p>Here we illustrate the features of the Ultimate Deconvolution (UD)
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stephenslab/udr" class="external-link">udr</a></span><span class="op">)</span></span></code></pre></div>
<p>We simulate 4,000 data points from a UD model with 4 mixture
components: <span class="math display">\[
x_i \sim w_1 N(0,V + U_1) + \cdots + w_4 N(0,V + U_4).
\]</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">4000</span></span>
<span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>none   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          shared <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,<span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">1.0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          only1  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          only2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.1</span>,<span class="fl">0.075</span>,<span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_ud_data.html">simulate_ud_data</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">w</span>,<span class="va">U</span>,<span class="va">V</span><span class="op">)</span></span></code></pre></div>
<p>This is the most basic usage, using the default settings:</p>
<p>Note: in this toy simulation example, we set model parameter <span class="math inline">\(V\)</span> to <span class="math inline">\(V\)</span> as we know the simulation truth. In
practice, it’s likely one needs to estimate <span class="math inline">\(V\)</span> and use <span class="math inline">\(\hat V\)</span> for <span class="math inline">\(V\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ud_init.html">ud_init</a></span><span class="op">(</span><span class="va">X</span>, V <span class="op">=</span> <span class="va">V</span><span class="op">)</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ud_fit.html">ud_fit</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span></span>
<span><span class="co"># Performing Ultimate Deconvolution on 4000 x 2 matrix (udr 0.3-144, "R"):</span></span>
<span><span class="co"># data points are i.i.d. (same V)</span></span>
<span><span class="co"># prior covariances: 2 scaled, 0 rank-1, 8 unconstrained</span></span>
<span><span class="co"># prior covariance updates: scaled (fa), rank-1 (none), unconstrained (ted)</span></span>
<span><span class="co"># mixture weights update: em</span></span>
<span><span class="co"># residual covariance update: none</span></span>
<span><span class="co"># max 20 updates, tol=1.0e-06, tol.lik=1.0e-03</span></span>
<span><span class="co"># iter          log-likelihood    log-likelihood.pen   |w - w'| |U - U'| |V - V'|</span></span>
<span><span class="co">#    1 -1.2279801614499656e+04 -1.2279801614499656e+04 4.68e-02 1.28e+01 0.00e+00</span></span>
<span><span class="co">#    2 -1.2223121182887791e+04 -1.2223121182887791e+04 8.81e-03 5.10e-01 0.00e+00</span></span>
<span><span class="co">#    3 -1.2212190514096219e+04 -1.2212190514096219e+04 6.38e-03 1.89e-01 0.00e+00</span></span>
<span><span class="co">#    4 -1.2208915989941652e+04 -1.2208915989941652e+04 4.86e-03 8.34e-02 0.00e+00</span></span>
<span><span class="co">#    5 -1.2207216178055960e+04 -1.2207216178055960e+04 4.05e-03 4.79e-02 0.00e+00</span></span>
<span><span class="co">#    6 -1.2206156194755680e+04 -1.2206156194755680e+04 3.50e-03 3.68e-02 0.00e+00</span></span>
<span><span class="co">#    7 -1.2205420599827859e+04 -1.2205420599827859e+04 3.08e-03 3.03e-02 0.00e+00</span></span>
<span><span class="co">#    8 -1.2204895950208514e+04 -1.2204895950208514e+04 2.74e-03 2.46e-02 0.00e+00</span></span>
<span><span class="co">#    9 -1.2204481484151787e+04 -1.2204481484151787e+04 2.48e-03 1.95e-02 0.00e+00</span></span>
<span><span class="co">#   10 -1.2204146611350558e+04 -1.2204146611350558e+04 2.26e-03 1.51e-02 0.00e+00</span></span>
<span><span class="co">#   11 -1.2203869862004891e+04 -1.2203869862004891e+04 2.07e-03 1.14e-02 0.00e+00</span></span>
<span><span class="co">#   12 -1.2203634312857637e+04 -1.2203634312857637e+04 1.91e-03 8.31e-03 0.00e+00</span></span>
<span><span class="co">#   13 -1.2203423126633246e+04 -1.2203423126633246e+04 1.78e-03 5.97e-03 0.00e+00</span></span>
<span><span class="co">#   14 -1.2203229410058899e+04 -1.2203229410058899e+04 1.67e-03 4.45e-03 0.00e+00</span></span>
<span><span class="co">#   15 -1.2203050790905421e+04 -1.2203050790905421e+04 1.59e-03 3.40e-03 0.00e+00</span></span>
<span><span class="co">#   16 -1.2202885720507049e+04 -1.2202885720507049e+04 1.51e-03 2.64e-03 0.00e+00</span></span>
<span><span class="co">#   17 -1.2202732934351641e+04 -1.2202732934351641e+04 1.43e-03 2.23e-03 0.00e+00</span></span>
<span><span class="co">#   18 -1.2202591340657174e+04 -1.2202591340657174e+04 1.37e-03 2.09e-03 0.00e+00</span></span>
<span><span class="co">#   19 -1.2202459977936309e+04 -1.2202459977936309e+04 1.30e-03 1.98e-03 0.00e+00</span></span>
<span><span class="co">#   20 -1.2202337990145770e+04 -1.2202337990145770e+04 1.24e-03 1.89e-03 0.00e+00</span></span></code></pre></div>
<p>The default model is a mixture with <span class="math inline">\(K =
10\)</span> mixture components: 2 scaled scaled and 8 unconstrained
prior covariance matrices <span class="math inline">\(U_k\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="co"># Model overview:</span></span>
<span><span class="co">#   Number of data points: 4000</span></span>
<span><span class="co">#   Dimension of data points: 2</span></span>
<span><span class="co"># Data points are i.i.d. (same V)</span></span>
<span><span class="co">#   Number of scaled prior covariances: 2</span></span>
<span><span class="co">#   Number of rank-1 prior covariances: 0</span></span>
<span><span class="co">#   Number of unconstrained prior covariances: 8</span></span>
<span><span class="co"># Evaluation of fit (20 updates performed):</span></span>
<span><span class="co">#   Log-likelihood: -1.220233799015e+04</span></span></code></pre></div>
<p>The function <code>ud_init</code> is a flexible interface for
defining a variety of UD models. For example,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ud_init.html">ud_init</a></span><span class="op">(</span><span class="va">X</span>,U_scaled <span class="op">=</span> <span class="va">U</span>,n_rank1 <span class="op">=</span> <span class="fl">1</span>,n_unconstrained <span class="op">=</span> <span class="fl">1</span>,V <span class="op">=</span> <span class="va">V</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ud_fit.html">ud_fit</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span><span class="co"># Performing Ultimate Deconvolution on 4000 x 2 matrix (udr 0.3-144, "R"):</span></span>
<span><span class="co"># data points are i.i.d. (same V)</span></span>
<span><span class="co"># prior covariances: 4 scaled, 1 rank-1, 1 unconstrained</span></span>
<span><span class="co"># prior covariance updates: scaled (fa), rank-1 (ted), unconstrained (ted)</span></span>
<span><span class="co"># mixture weights update: em</span></span>
<span><span class="co"># residual covariance update: none</span></span>
<span><span class="co"># max 20 updates, tol=1.0e-06, tol.lik=1.0e-03</span></span>
<span><span class="co"># iter          log-likelihood    log-likelihood.pen   |w - w'| |U - U'| |V - V'|</span></span>
<span><span class="co">#    1 -1.2254274362870696e+04 -1.2254274362870696e+04 2.15e-02 1.01e+00 0.00e+00</span></span>
<span><span class="co">#    2 -1.2234214947219918e+04 -1.2234214947219918e+04 7.12e-03 2.99e-01 0.00e+00</span></span>
<span><span class="co">#    3 -1.2224394571088986e+04 -1.2224394571088986e+04 5.32e-03 1.62e-01 0.00e+00</span></span>
<span><span class="co">#    4 -1.2219820969075176e+04 -1.2219820969075176e+04 4.73e-03 1.00e-01 0.00e+00</span></span>
<span><span class="co">#    5 -1.2216889113988313e+04 -1.2216889113988313e+04 4.15e-03 6.61e-02 0.00e+00</span></span>
<span><span class="co">#    6 -1.2214904923232063e+04 -1.2214904923232063e+04 3.61e-03 4.32e-02 0.00e+00</span></span>
<span><span class="co">#    7 -1.2213781656532648e+04 -1.2213781656532648e+04 3.12e-03 4.90e-03 0.00e+00</span></span>
<span><span class="co">#    8 -1.2212842079018839e+04 -1.2212842079018839e+04 2.83e-03 5.29e-09 0.00e+00</span></span>
<span><span class="co">#    9 -1.2211992244080759e+04 -1.2211992244080759e+04 2.66e-03 1.01e-08 0.00e+00</span></span>
<span><span class="co">#   10 -1.2211222160321957e+04 -1.2211222160321957e+04 2.53e-03 9.72e-09 0.00e+00</span></span>
<span><span class="co">#   11 -1.2210522990459391e+04 -1.2210522990459391e+04 2.41e-03 9.72e-09 0.00e+00</span></span>
<span><span class="co">#   12 -1.2209886923631164e+04 -1.2209886923631164e+04 2.30e-03 3.31e-24 0.00e+00</span></span>
<span><span class="co">#   13 -1.2209307059168852e+04 -1.2209307059168852e+04 2.19e-03 3.31e-24 0.00e+00</span></span>
<span><span class="co">#   14 -1.2208777302101074e+04 -1.2208777302101074e+04 2.09e-03 1.08e-08 0.00e+00</span></span>
<span><span class="co">#   15 -1.2208292268713056e+04 -1.2208292268713056e+04 2.07e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   16 -1.2207847203500649e+04 -1.2207847203500649e+04 2.06e-03 1.08e-08 0.00e+00</span></span>
<span><span class="co">#   17 -1.2207437904917895e+04 -1.2207437904917895e+04 2.04e-03 5.63e-09 0.00e+00</span></span>
<span><span class="co">#   18 -1.2207060657974238e+04 -1.2207060657974238e+04 2.02e-03 5.63e-09 0.00e+00</span></span>
<span><span class="co">#   19 -1.2206712178043186e+04 -1.2206712178043186e+04 2.00e-03 1.08e-08 0.00e+00</span></span>
<span><span class="co">#   20 -1.2206389557276261e+04 -1.2206389557276261e+04 1.97e-03 3.31e-24 0.00e+00</span></span>
<span><span class="co"># Model overview:</span></span>
<span><span class="co">#   Number of data points: 4000</span></span>
<span><span class="co">#   Dimension of data points: 2</span></span>
<span><span class="co"># Data points are i.i.d. (same V)</span></span>
<span><span class="co">#   Number of scaled prior covariances: 4</span></span>
<span><span class="co">#   Number of rank-1 prior covariances: 1</span></span>
<span><span class="co">#   Number of unconstrained prior covariances: 1</span></span>
<span><span class="co"># Evaluation of fit (20 updates performed):</span></span>
<span><span class="co">#   Log-likelihood: -1.220638955728e+04</span></span></code></pre></div>
<p>The <code>ud_fit</code> interface also allows for flexibly re-fitting
a model; that is, a <code>ud_fit</code> output can be used in another
call to <code>ud_fit</code>. There is also a more advanced model fitting
interface for more fine-grained control; see
<code>help(ud_fit_advanced)</code> for details.</p>
<p>Notice that the data do not need to be passed to <code>ud_fit</code>
because they are already embedded in the <code>ud_fit</code> output.
However, one can also pass a new data set <code>X</code> to
<code>ud_fit</code>.</p>
<p>The <code>control</code> argument to <code>ud_fit</code> controls the
optimization of the model parameters. For example, the unconstrained
prior covariance matrices are by default optimized using the “truncated
eigenvalue decomposition” (TED) updates, and we can replace these with
the Extreme Deconvolution (ED) updates:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ud_fit.html">ud_fit</a></span><span class="op">(</span><span class="va">fit0</span>,control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>unconstrained.update <span class="op">=</span> <span class="st">"ed"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Performing Ultimate Deconvolution on 4000 x 2 matrix (udr 0.3-144, "R"):</span></span>
<span><span class="co"># data points are i.i.d. (same V)</span></span>
<span><span class="co"># prior covariances: 4 scaled, 1 rank-1, 1 unconstrained</span></span>
<span><span class="co"># prior covariance updates: scaled (fa), rank-1 (ted), unconstrained (ed)</span></span>
<span><span class="co"># mixture weights update: em</span></span>
<span><span class="co"># residual covariance update: none</span></span>
<span><span class="co"># max 20 updates, tol=1.0e-06, tol.lik=1.0e-03</span></span>
<span><span class="co"># iter          log-likelihood    log-likelihood.pen   |w - w'| |U - U'| |V - V'|</span></span>
<span><span class="co">#    1 -1.2287368932550235e+04 -1.2287368932550235e+04 2.15e-02 5.02e-01 0.00e+00</span></span>
<span><span class="co">#    2 -1.2267084706127493e+04 -1.2267084706127493e+04 1.19e-02 2.29e-01 0.00e+00</span></span>
<span><span class="co">#    3 -1.2254869264065783e+04 -1.2254869264065783e+04 8.55e-03 1.37e-01 0.00e+00</span></span>
<span><span class="co">#    4 -1.2246443004794617e+04 -1.2246443004794617e+04 7.70e-03 9.27e-02 0.00e+00</span></span>
<span><span class="co">#    5 -1.2240164280190913e+04 -1.2240164280190913e+04 7.05e-03 6.75e-02 0.00e+00</span></span>
<span><span class="co">#    6 -1.2235254049624667e+04 -1.2235254049624667e+04 6.52e-03 5.16e-02 0.00e+00</span></span>
<span><span class="co">#    7 -1.2231287048520800e+04 -1.2231287048520800e+04 6.07e-03 4.08e-02 0.00e+00</span></span>
<span><span class="co">#    8 -1.2228007009908366e+04 -1.2228007009908366e+04 5.68e-03 3.31e-02 0.00e+00</span></span>
<span><span class="co">#    9 -1.2225247786758919e+04 -1.2225247786758919e+04 5.33e-03 2.73e-02 0.00e+00</span></span>
<span><span class="co">#   10 -1.2222895469731768e+04 -1.2222895469731768e+04 5.01e-03 2.30e-02 0.00e+00</span></span>
<span><span class="co">#   11 -1.2220868482802136e+04 -1.2220868482802136e+04 4.72e-03 1.95e-02 0.00e+00</span></span>
<span><span class="co">#   12 -1.2219106350217282e+04 -1.2219106350217282e+04 4.46e-03 1.68e-02 0.00e+00</span></span>
<span><span class="co">#   13 -1.2217562978153386e+04 -1.2217562978153386e+04 4.22e-03 1.45e-02 0.00e+00</span></span>
<span><span class="co">#   14 -1.2216202436938260e+04 -1.2216202436938260e+04 3.99e-03 1.27e-02 0.00e+00</span></span>
<span><span class="co">#   15 -1.2214996199525513e+04 -1.2214996199525513e+04 3.78e-03 1.12e-02 0.00e+00</span></span>
<span><span class="co">#   16 -1.2213921270641369e+04 -1.2213921270641369e+04 3.59e-03 9.87e-03 0.00e+00</span></span>
<span><span class="co">#   17 -1.2212958877040135e+04 -1.2212958877040135e+04 3.41e-03 8.76e-03 0.00e+00</span></span>
<span><span class="co">#   18 -1.2212093527740029e+04 -1.2212093527740029e+04 3.24e-03 7.82e-03 0.00e+00</span></span>
<span><span class="co">#   19 -1.2211312324993052e+04 -1.2211312324993052e+04 3.08e-03 7.13e-03 0.00e+00</span></span>
<span><span class="co">#   20 -1.2210604444683637e+04 -1.2210604444683637e+04 2.93e-03 6.61e-03 0.00e+00</span></span></code></pre></div>
<p>Notice that the likelihood is slightly higher with the TED updates,
reflecting the fact that the TED updates have greater freedom to
optimize the covariance matrices.</p>
<p>These are the current model fitting defaults:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/ud_fit.html">ud_fit_control_default</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#       weights.update         resid.update        scaled.update </span></span>
<span><span class="co">#                   NA                   NA                   NA </span></span>
<span><span class="co">#         rank1.update unconstrained.update              version </span></span>
<span><span class="co">#                   NA                   NA                  "R" </span></span>
<span><span class="co">#              maxiter               minval                  tol </span></span>
<span><span class="co">#                 "20"              "1e-08"              "1e-06" </span></span>
<span><span class="co">#              tol.lik       zero.threshold     update.threshold </span></span>
<span><span class="co">#              "0.001"              "1e-15"              "0.001" </span></span>
<span><span class="co">#               lambda         penalty.type </span></span>
<span><span class="co">#                  "0"                 "iw"</span></span></code></pre></div>
<p>The most intensive computations are implemented in R
(<code>control$version = R</code>) and C++
(<code>control$version = Rcpp</code>); both versions should return the
same, or nearly the same output, but the C++ version can sometimes be
much faster.</p>
<p>In some cases each sample might have different measurement error, and
udr can handle such cases by specifying <code>V</code> as a list instead
of a matrix:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ud_init.html">ud_init</a></span><span class="op">(</span><span class="va">X</span>,V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>,<span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ud_fit.html">ud_fit</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span></span>
<span><span class="co"># Performing Ultimate Deconvolution on 4000 x 2 matrix (udr 0.3-144, "R"):</span></span>
<span><span class="co"># data points are not i.i.d. (different Vs)</span></span>
<span><span class="co"># prior covariances: 2 scaled, 0 rank-1, 8 unconstrained</span></span>
<span><span class="co"># prior covariance updates: scaled (none), rank-1 (none), unconstrained (none)</span></span>
<span><span class="co"># mixture weights update: em</span></span>
<span><span class="co"># max 20 updates, tol=1.0e-06, tol.lik=1.0e-03</span></span>
<span><span class="co"># iter          log-likelihood    log-likelihood.pen   |w - w'| |U - U'| |V - V'|</span></span>
<span><span class="co">#    1 -1.3805879530064036e+04 -1.3805879530064036e+04 5.94e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    2 -1.3490340592972956e+04 -1.3490340592972956e+04 6.76e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    3 -1.3250364428611714e+04 -1.3250364428611714e+04 6.86e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    4 -1.3071921980151610e+04 -1.3071921980151610e+04 6.37e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    5 -1.2941705117707856e+04 -1.2941705117707856e+04 5.54e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    6 -1.2847990772326337e+04 -1.2847990772326337e+04 4.59e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    7 -1.2781081111651431e+04 -1.2781081111651431e+04 3.70e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    8 -1.2733419541665267e+04 -1.2733419541665267e+04 2.94e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#    9 -1.2699392526575763e+04 -1.2699392526575763e+04 2.31e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   10 -1.2674965124613851e+04 -1.2674965124613851e+04 1.82e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   11 -1.2657294509511747e+04 -1.2657294509511747e+04 1.44e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   12 -1.2644397982178429e+04 -1.2644397982178429e+04 1.15e-02 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   13 -1.2634896984685392e+04 -1.2634896984685392e+04 9.24e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   14 -1.2627831240020840e+04 -1.2627831240020840e+04 7.53e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   15 -1.2622528327349333e+04 -1.2622528327349333e+04 6.20e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   16 -1.2618513854100438e+04 -1.2618513854100438e+04 5.18e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   17 -1.2615450149042339e+04 -1.2615450149042339e+04 4.38e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   18 -1.2613094535230090e+04 -1.2613094535230090e+04 3.75e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   19 -1.2611270880733064e+04 -1.2611270880733064e+04 3.25e-03 0.00e+00 0.00e+00</span></span>
<span><span class="co">#   20 -1.2609850106127040e+04 -1.2609850106127040e+04 2.85e-03 0.00e+00 0.00e+00</span></span></code></pre></div>
<p>The TED updates cannot be applied to this setting, so the ED updates
must be used instead.</p>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>This is the version of R and the packages that were used to generate
these results:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># R version 4.2.0 (2022-04-22)</span></span>
<span><span class="co"># Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co"># Running under: CentOS Linux 7 (Core)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Matrix products: default</span></span>
<span><span class="co"># BLAS/LAPACK: /software/openblas-0.3.13-el7-x86_64/lib/libopenblas_haswellp-r0.3.13.so</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># locale:</span></span>
<span><span class="co">#  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co"># [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># attached base packages:</span></span>
<span><span class="co"># [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># other attached packages:</span></span>
<span><span class="co"># [1] udr_0.3-147</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># loaded via a namespace (and not attached):</span></span>
<span><span class="co">#  [1] Rcpp_1.0.8.3      knitr_1.39        magrittr_2.0.3    R6_2.5.1         </span></span>
<span><span class="co">#  [5] ragg_1.2.5        rlang_1.0.2       fastmap_1.1.0     stringr_1.4.0    </span></span>
<span><span class="co">#  [9] tools_4.2.0       xfun_0.30         cli_3.3.0         jquerylib_0.1.4  </span></span>
<span><span class="co"># [13] htmltools_0.5.2   systemfonts_1.0.4 yaml_2.3.5        digest_0.6.29    </span></span>
<span><span class="co"># [17] rprojroot_2.0.3   pkgdown_2.0.7     textshaping_0.3.6 purrr_0.3.4      </span></span>
<span><span class="co"># [21] sass_0.4.1        fs_1.5.2          memoise_2.0.1     cachem_1.0.6     </span></span>
<span><span class="co"># [25] evaluate_0.15     rmarkdown_2.14    stringi_1.7.6     compiler_4.2.0   </span></span>
<span><span class="co"># [29] bslib_0.3.1       desc_1.4.1        mvtnorm_1.1-3     jsonlite_1.8.0</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Peter Carbonetto, Yunqi Yang, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
